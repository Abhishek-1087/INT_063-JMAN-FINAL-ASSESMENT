
  
    

        create or replace transient table JMAN_ASSESSMENT.JMAN.stg_certificatedetails
         as
        (

WITH certificate_details_original AS (
    SELECT 
        EMPID AS EMPLOYEE_ID,
        CERTIFICATENAME AS CERTIFICATE_NAME,
        ISSUINGORGANIZATION AS ISSUING_ORGANIZATION,
        ISSUEDATE AS ISSUE_DATE,
        EXPIREDATE AS EXPIRE_DATE,
        CREDENTIALID AS CREDENTIAL_ID,
        STATUS AS CERTIFICATE_STATUS
    FROM JMAN_ASSESSMENT.JMAN.CERTIFICATEDETAILS
),

certificate_details_modified AS (
    SELECT 
        CAST(EMPLOYEE_ID AS VARCHAR(10)) AS EMPLOYEE_ID,
        CAST(CERTIFICATE_NAME AS VARCHAR(50)) AS CERTIFICATE_NAME,
        CAST(ISSUING_ORGANIZATION AS VARCHAR(100)) AS ISSUING_ORGANIZATION,
        CAST(ISSUE_DATE AS VARCHAR(15)) AS ISSUE_DATE,
        CAST(EXPIRE_DATE AS VARCHAR(15)) AS EXPIRE_DATE,
        CAST(CREDENTIAL_ID AS VARCHAR(100)) AS CREDENTIAL_ID,
        CAST(CERTIFICATE_STATUS AS VARCHAR(20)) AS CERTIFICATE_STATUS
    FROM certificate_details_original
)

SELECT * FROM certificate_details_modified
        );
      
  